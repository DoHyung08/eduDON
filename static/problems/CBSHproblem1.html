<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¬¸ì œ 1 - ì•”í˜¸ ë¬¸ì œ ì‚¬ì´íŠ¸</title>
    <link rel="stylesheet" href="../../styles.css">
    <style>
        /* í´ë¦­ ê²Œì„ ì „ìš© ìŠ¤íƒ€ì¼ */
        #game-container {
            position: relative;
            display: inline-block;
            margin: 2rem 0;
        }
        #clickable {
            cursor: pointer;
            user-select: none;
            width: 300px;
            height: auto;
            opacity: 0.1;
            transition: opacity 0.2s ease;
            border-radius: 10px;
        }
        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            pointer-events: none;
            background: hsl(var(--h, 0), 100%, 50%);
            will-change: transform, opacity;
        }
        #remaining {
            font-size: 1.2rem;
            margin: 1rem 0;
            color: #333;
            font-weight: bold;
        }
        .game-content {
            text-align: center;
            padding: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ì •ë³´ ë°” -->
    <header class="info-bar">
        <div class="info-left"></div>
        <div class="info-center">
            <h1>CBSH ë°©íƒˆì¶œ</h1>
        </div>
        <div class="info-right"></div>
    </header>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="main-content">
        <div class="problem-container">
            <h2>ë¬¸ì œ 1: ì‚¬ì§„ì„ í´ë¦­í•´ì„œ í”Œë˜ê·¸ë¥¼ ì°¾ì•„ë³´ì„¸ìš”!</h2>
            <p>
                ì•„ë˜ ì´ë¯¸ì§€ë¥¼ 1000ë²ˆ í´ë¦­í•˜ë©´ ìˆ¨ê²¨ì§„ í”Œë˜ê·¸ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.<br>
                í´ë¦­í•  ë•Œë§ˆë‹¤ ì´ë¯¸ì§€ê°€ ì ì  ì„ ëª…í•´ì§€ë©°, íŒŒí‹°í´ íš¨ê³¼ë„ í•¨ê»˜ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
            </p>
            
            <div class="game-content">
                <div id="game-container">
                    <img id="clickable" src="CBSHpro1/ì—ë””.jpg" alt="Click me">
                </div>
                <p id="remaining"></p>
            </div>
            
            <!-- ê²°ê³¼ë¥¼ í‘œì‹œí•  div -->
            <div class="result-message" id="problemResult" style="max-width: 400px; margin: 1rem auto 0;"></div>

            <div style="text-align: center;">
                <a href="../index.html" class="back-button">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
            </div>
        </div>
    </main>

    <script>
        // ì•”í˜¸í™”ëœ í”Œë˜ê·¸ì™€ ë³µí˜¸í™” í•¨ìˆ˜
        const encrypted = [23,16,17,10,23,29,24,25,14,38,4,10,52,13,24,3,29,24,10,20,8];
        const KEY = 'mykey';
        function decrypt(key) {
            return String.fromCharCode(
                ...encrypted.map((b,i) => b ^ key.charCodeAt(i % key.length))
            );
        }

        // ê²Œì„ ë³€ìˆ˜ë“¤
        var MAX = 1000;
        let counter = 0;
        const remEl = document.getElementById('remaining');
        const imgEl = document.getElementById('clickable');
        const container = document.getElementById('game-container');
        const resultDiv = document.getElementById('problemResult');

        // ì´ˆê¸° ìƒíƒœ ì„¤ì •
        remEl.textContent = `${MAX}ë²ˆ í´ë¦­ì´ í•„ìš”í•©ë‹ˆë‹¤`;

        // ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function showProblemResult(message, type) {
            resultDiv.textContent = message;
            resultDiv.className = `result-message ${type} show`;
        }

        // íŒŒí‹°í´ íš¨ê³¼ í•¨ìˆ˜
        function explode(x, y) {
            const count = 30;
            for (let i = 0; i < count; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.setProperty('--h', Math.random() * 360);
                p.style.left = x + 'px';
                p.style.top = y + 'px';
                container.appendChild(p);
                const angle = Math.random() * Math.PI * 2;
                const speed = 2 + Math.random() * 3;
                const vx = Math.cos(angle) * speed;
                const vy = Math.sin(angle) * speed;
                let life = 0;
                (function animate() {
                    if (life > 30) return p.remove();
                    p.style.transform = `translate(${vx * life}px, ${vy * life}px)`;
                    p.style.opacity = `${1 - life / 30}`;
                    life++;
                    requestAnimationFrame(animate);
                })();
            }
        }

        // í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        imgEl.addEventListener('click', ev => {
            const rect = container.getBoundingClientRect();
            const x = ev.clientX - rect.left;
            const y = ev.clientY - rect.top;
            explode(x, y);

            counter++;
            imgEl.style.opacity = Math.min(1, 0.1 + 0.9 * (counter / MAX));

            if (counter < MAX) {
                remEl.textContent = `${MAX - counter}ë²ˆ ë” í´ë¦­í•˜ì„¸ìš”`;
            } else {
                const flag = decrypt(KEY);
                remEl.textContent = `ğŸ‰ ê²Œì„ ì™„ë£Œ!`;
                showProblemResult(`ì •ë‹µì…ë‹ˆë‹¤! ì²« ë²ˆì§¸ ìˆ«ìëŠ” "9" ì…ë‹ˆë‹¤. FLAG: ${flag}`, 'success');
                imgEl.style.pointerEvents = 'none';
            }
        });
    </script>
</body>
</html>